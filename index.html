<!DOCTYPE html>
<html>

<head>
<script type="text/javascript" src="jquery-1.8.3.js"></script>

<title>Reel Run</title>

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

<script type="text/javascript">


function whichDisplay(){
	//window.alert("sometext");
	
	const divElementOne = document.getElementById("StartGame");
	const divElementTwo = document.getElementById("AuthContPage");
	
	divElementOne.style.display = "block";
	divElementTwo.style.display = "none";


}

function authFitBit(){
	const originalURL = this.href;
	const authURL = "https://www.fitbit.com/oauth2/authorize?response_type=code&client_id=23Q4C5&scope=activity+cardio_fitness+electrocardiogram+heartrate+irregular_rhythm_notifications+location+nutrition+oxygen_saturation+profile+respiratory_rate+settings+sleep+social+temperature+weight&code_challenge=TYTQ6GEfJ59fixjpMcc_XnqwgyV-XgeDvdQWp84kNhA&code_challenge_method=S256&redirect_uri=https%3A%2F%2Fsamisamsamsam.github.io";
	window.location.href = authURL;
	
//	userComeBack(originalURL, authURL);
	
}

//function userComeBack(firstURL, secondURL){
	
	//const checkRedirect = setInterval(function() {

   // if ((window.location.href !== firstURL) && (window.location.href !== secondURL) {
	//	window.alert("sometext");

  //    const redirectURL = window.location.href; // Get redirect URL
		
	//	myCallBack(redirectURL);
      // Perform actions using the redirectUrl

     // clearInterval(checkRedirect); // Stop checking

   // }

 // }, 100); // Check every 100 milliseconds

	//}
	


//}


function myCallBack(){
	var url = window.location.href;
	window.alert(url);
	const divElementOne = document.getElementById("StartGame");
	const divElementTwo = document.getElementById("AuthContPage");
	
	divElementOne.style.display = "none";
	divElementTwo.style.display = "block";
	
	// get the url
	var url = window.location.href;
	//getting the access token from url 
	var access_token = url.split("#")[1].split("=")[1].split("&")[0]; 
	// get the userid 
	var userId = url.split("#")[1].split("=")[2].split("&")[0]; 

	window.alert(userId);

}


</script>

</head>


<body onload ="whichDisplay()">
<br><br><br><br><br><br>

<div id="StartGame">
<div class="row">
 	 <div class="col-sm-4"></div>
     <div class="col-sm-4">
         <div style="text-align:center;">
		
		 <button type="button" class="btn btn-success form-control" onclick="authFitBit();">
		 Log In
		</button>
         </div>
	 </div>
	 <div class="col-sm-4"></div>
</div>                    

 
</div>
<!-- Second page after user gives authorization for fitbit access
	-->
<div id="AuthContPage">


<div>hello second page</div>

</div>


<!-- 
	-->
</body>
</html>